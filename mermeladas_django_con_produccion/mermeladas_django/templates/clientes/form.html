{% extends 'base.html' %}
{% block title %}Cliente{% endblock %}

{% block page_title %}
  {% if form.instance.pk %}
    <i class="bi bi-pencil-square me-2"></i>Editar cliente
  {% else %}
    <i class="bi bi-person-plus me-2"></i>Crear cliente
  {% endif %}
{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-8 col-xl-6">
    <div class="card shadow-sm border-0">
      <div class="card-body">
        <form method="post">
          {% csrf_token %}

          {{ form.as_p }}

          <div class="mt-4">
            <button class="btn btn-primary">
              <i class="bi bi-save me-1"></i>Guardar
            </button>
            <a href="{% url 'clientes_list' %}" class="btn btn-secondary">
              <i class="bi bi-arrow-left me-1"></i>Volver
            </a>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
(function() {
  document.querySelectorAll('form > div.card-body p').forEach(p => {
    const label = p.querySelector('label');
    const input = p.querySelector('input, select, textarea');

    if (label && input) {
      p.classList.add('mb-3');
      label.classList.add('form-label');

      if (input.type !== 'checkbox' && input.type !== 'radio' && input.type !== 'file') {
        if (input.tagName === 'SELECT') {
          input.classList.add('form-select');
        } else {
          input.classList.add('form-control');
        }
      }

      const error = p.querySelector('.errorlist');
      if (error) {
        error.querySelectorAll('li').forEach(li => {
          const errorDiv = document.createElement('div');
          errorDiv.classList.add('invalid-feedback', 'd-block');
          errorDiv.textContent = li.textContent;
          input.after(errorDiv);
        });
        input.classList.add('is-invalid');
        error.remove();
      }

      const div = document.createElement('div');
      div.innerHTML = p.innerHTML;
      Array.from(p.attributes).forEach(attr => div.setAttribute(attr.name, attr.value));
      p.replaceWith(div);
    }
  });
})();
</script>
{% endblock %}