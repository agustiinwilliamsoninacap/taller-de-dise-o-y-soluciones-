{% extends 'base.html' %}
{% block title %}Detalle de Receta{% endblock %}

{% block content %}
<div class="container py-4">

  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h6 class="text-uppercase text-muted ls-1 mb-1 small fw-bold">Ficha TÃ©cnica</h6>
        <h2 class="fw-bold mb-0 text-dark">
            <i class="bi bi-journal-text me-2 text-primary"></i>{{ receta.nombre }}
        </h2>
    </div>
    <div class="d-flex gap-2">
        <a href="{% url 'receta_update' receta.pk %}" class="btn btn-outline-secondary rounded-pill px-4">
            <i class="bi bi-pencil me-2"></i>Editar
        </a>
        <a href="{% url 'receta_producir' receta.pk %}" class="btn btn-success rounded-pill px-4 shadow-sm fw-bold">
            <i class="bi bi-play-circle-fill me-2"></i>PRODUCIR
        </a>
    </div>
  </div>

  <div class="row g-4 mb-4">
    <div class="col-md-4">
        <div class="card border-0 shadow-sm h-100 rounded-4 overflow-hidden">
            <div class="card-body bg-danger bg-opacity-10 d-flex flex-column align-items-center justify-content-center text-center p-4">
                <div class="bg-white p-3 rounded-circle shadow-sm mb-3 text-danger">
                    <i class="bi bi-tag-fill fs-2"></i>
                </div>
                <h6 class="text-uppercase text-muted small fw-bold mb-1">Producto Final</h6>
                <h4 class="fw-bold text-danger mb-0">{{ receta.producto_final }}</h4>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card border-0 shadow-sm h-100 rounded-4 overflow-hidden">
            <div class="card-body bg-primary bg-opacity-10 d-flex flex-column align-items-center justify-content-center text-center p-4">
                <div class="bg-white p-3 rounded-circle shadow-sm mb-3 text-primary">
                    <i class="bi bi-box-seam fs-2"></i>
                </div>
                <h6 class="text-uppercase text-muted small fw-bold mb-1">Rendimiento Esperado</h6>
                <h4 class="fw-bold text-primary mb-0">{{ receta.rendimiento_unidades|floatformat:0 }} Unidades</h4>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card border-0 shadow-sm h-100 rounded-4 overflow-hidden">
            <div class="card-body bg-warning bg-opacity-10 d-flex flex-column align-items-center justify-content-center text-center p-4">
                <div class="bg-white p-3 rounded-circle shadow-sm mb-3 text-warning">
                    <i class="bi bi-currency-dollar fs-2"></i>
                </div>
                <h6 class="text-uppercase text-muted small fw-bold mb-1">Costo Estimado</h6>
                <h4 class="fw-bold text-dark mb-0 font-monospace">${{ receta.costo_estandar|floatformat:0 }}</h4>
                <small class="text-muted">por lote completo</small>
            </div>
        </div>
    </div>
  </div>

  <div class="card border-0 shadow-sm rounded-4">
    <div class="card-header bg-white border-0 py-3 px-4">
        <h5 class="fw-bold mb-0 text-secondary">
            <i class="bi bi-basket me-2"></i>Lista de Ingredientes
        </h5>
    </div>
    <div class="card-body p-0">
        <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">
                <thead class="bg-light">
                    <tr>
                        <th class="ps-4 py-3 text-uppercase small fw-bold text-secondary border-0">Materia Prima</th>
                        <th class="py-3 text-uppercase small fw-bold text-secondary border-0 text-end pe-4">Cantidad Requerida</th>
                    </tr>
                </thead>
                <tbody>
                {% for i in receta.items.all %}
                    <tr>
                        <td class="ps-4 border-bottom-0">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-check2-circle text-success me-3"></i>
                                <span class="fw-medium text-dark">{{ i.materia_prima }}</span>
                            </div>
                        </td>
                        <td class="text-end pe-4 border-bottom-0">
                            <span class="badge bg-secondary-subtle text-dark border px-3 py-2 rounded-pill font-monospace fs-6">
                                {{ i.cantidad|floatformat:0 }}
                            </span>
                        </td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="2" class="text-center py-5">
                            <span class="text-muted">No hay ingredientes cargados en esta receta.</span>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
  </div>

  <div class="mt-4">
    <a href="{% url 'recetas_list' %}" class="btn btn-link text-decoration-none text-muted p-0">
        <i class="bi bi-arrow-left me-1"></i>Volver al recetario
    </a>
  </div>

</div>
{% endblock %}
